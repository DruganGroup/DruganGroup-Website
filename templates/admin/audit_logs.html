{% extends "admin/base.html" %}

{% block title %}Audit Trail | Business Better{% endblock %}

{% block styles %}
<style>
    /* Badge Styles specific to logs */
    .badge-action {
        display: inline-block; 
        padding: 3px 10px; 
        font-size: 0.7rem;
        font-weight: 700; 
        text-transform: uppercase; 
        letter-spacing: 0.5px;
        color: var(--primary-gold); 
        border: 1px solid rgba(197, 160, 89, 0.4);
        border-radius: 4px; 
        white-space: nowrap;
    }
    
    .details-text { 
        color: #b0b0b0; 
        font-size: 0.85rem; 
        max-width: 400px; 
        display: block; 
        overflow: hidden; 
        text-overflow: ellipsis; 
    }
    
    .ip-text { 
        color: #666; 
        font-family: monospace; 
        font-size: 0.75rem; 
    }
    
    /* Pagination Buttons */
    .btn-page { 
        background: transparent; 
        border: 1px solid var(--primary-gold); 
        color: var(--primary-gold); 
        padding: 6px 15px; 
        border-radius: 5px; 
        text-decoration: none; 
        font-size: 0.85rem; 
        font-weight: 600; 
        transition: 0.2s; 
    }
    .btn-page:hover { 
        background: var(--primary-gold); 
        color: #000; 
    }
    .btn-page.disabled { 
        opacity: 0.3; 
        pointer-events: none; 
        border-color: #444; 
        color: #444; 
    }
</style>
{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-end mb-5">
    <div>
        <h6 class="text-muted text-uppercase mb-1">Security Centre</h6>
        <h2 class="fw-bold mb-0 text-white">Audit <span class="text-gold">Trail</span></h2>
    </div>
    <div><span class="text-muted small">Tracking all administrative actions</span></div>
</div>

<div class="card-dark">
    <table class="table table-dark-custom table-hover mb-0">
        <thead>
            <tr>
                <th>Time</th>
                <th>Admin</th>
                <th>Action</th>
                <th>Target</th>
                <th>Details</th>
                <th>IP Address</th>
            </tr>
        </thead>
        <tbody>
{% for log in logs %}
            <tr>
                <td style="color: #888; font-family: monospace;">{{ log[0] }}</td> 
                
                <td>
                    <div class="d-flex align-items-center gap-2">
                        <i class="fas fa-user-circle text-secondary"></i>
                        <span class="fw-semibold text-white">{{ log[1] }}</span>
                    </div>
                </td> 
                
                <td><span class="badge-action">{{ log[2] }}</span></td> 
                
                <td style="color: #ccc;">{{ log[3] }}</td> 
                
                <td class="details-text">{{ log[4] }}</td>
                
                <td class="ip-text">{{ log[5] }}</td> 
            </tr>
            {% else %}
            <tr><td colspan="6" class="text-center p-5 text-muted">No audit records found.</td></tr>
            {% endfor %}
        </tbody>
    </table>

    {% if total_pages is defined and total_pages > 1 %}
    <div class="d-flex justify-content-between align-items-center p-3" style="border-top: 1px solid #333;">
        <div class="text-muted small">Page <strong>{{ page }}</strong> of {{ total_pages }}</div>
        <div class="d-flex gap-2">
            <a href="{{ url_for('admin.view_audit_logs', page=page-1) }}" class="btn-page {{ 'disabled' if page <= 1 }}">
                <i class="fas fa-chevron-left me-1"></i> Prev
            </a>
            <a href="{{ url_for('admin.view_audit_logs', page=page+1) }}" class="btn-page {{ 'disabled' if page >= total_pages }}">
                Next <i class="fas fa-chevron-right ms-1"></i>
            </a>
        </div>
    </div>
    {% endif %}
</div>
{% endblock %}
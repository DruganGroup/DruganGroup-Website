{% extends "admin/layout.html" %}

{% block content %}
<div class="dash-header">
    <div>
        <a href="/super-admin/analytics" style="text-decoration: none; color: #888; font-size: 0.9rem;">
            <i class="fas fa-arrow-left"></i> Back to Analytics
        </a>
        <h1 style="margin-top: 5px;">{{ company.name }}</h1>
        <span style="color: #888;">{{ company.subdomain }} | <span style="color: var(--primary-gold);">{{ company.plan }}</span></span>
    </div>
    <div>
        <a href="/admin/assign-me/{{ company.id }}" class="btn-main">
            <i class="fas fa-user-secret"></i> Login as Owner
        </a>
    </div>
</div>

<div class="form-grid" style="grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 30px;">
    <div class="admin-card">
        <h3><i class="fas fa-heartbeat" style="color: #e74c3c;"></i> System Health</h3>
        <ul style="list-style: none; padding: 0; color: #aaa; margin-top: 15px;">
            <li style="margin-bottom: 10px; display: flex; justify-content: space-between;">
                <span>Database Rows:</span> <span style="color: white;">{{ stats.users + stats.staff + stats.clients + stats.jobs + stats.transactions }}</span>
            </li>
            <li style="margin-bottom: 10px; display: flex; justify-content: space-between;">
                <span>Storage Used:</span> <span style="color: white;">{{ stats.storage_mb }} MB</span>
            </li>
            <li style="display: flex; justify-content: space-between;">
                <span>Status:</span> 
                <span style="color: {% if company.status == 'Active' %}#2ecc71{% else %}#e74c3c{% endif %}; font-weight: bold;">
                    {{ company.status }}
                </span>
            </li>
        </ul>
    </div>

    <div class="admin-card">
        <h3><i class="fas fa-briefcase" style="color: #3498db;"></i> Business Stats</h3>
        <ul style="list-style: none; padding: 0; color: #aaa; margin-top: 15px;">
            <li style="margin-bottom: 10px; display: flex; justify-content: space-between;">
                <span>Staff Count:</span> <span style="color: white;">{{ stats.staff }}</span>
            </li>
            <li style="margin-bottom: 10px; display: flex; justify-content: space-between;">
                <span>Client Base:</span> <span style="color: white;">{{ stats.clients }}</span>
            </li>
            <li style="display: flex; justify-content: space-between;">
                <span>Revenue (Recorded):</span> <span style="color: var(--primary-gold);">Â£{{ "%.2f"|format(stats.total_revenue) }}</span>
            </li>
        </ul>
    </div>

    <div class="admin-card">
        <h3><i class="fas fa-cogs" style="color: #f1c40f;"></i> Setup / Config</h3>
        <ul style="list-style: none; padding: 0; color: #aaa; margin-top: 15px;">
            <li style="margin-bottom: 10px; display: flex; justify-content: space-between;">
                <span>VAT Registered:</span> <span style="color: white;">{{ settings.get('vat_registered', 'No')|upper }}</span>
            </li>
            <li style="margin-bottom: 10px; display: flex; justify-content: space-between;">
                <span>Brand Color:</span> 
                <span style="color: {{ settings.get('brand_color', '#fff') }};">
                    <i class="fas fa-circle"></i> {{ settings.get('brand_color', 'None') }}
                </span>
            </li>
            <li style="display: flex; justify-content: space-between;">
                <span>Bank Configured:</span> 
                <span style="color: white;">{{ 'Yes' if settings.get('bank_name') else 'No' }}</span>
            </li>
        </ul>
    </div>
</div>

<div class="admin-card">
    <h3>Data Breakdown</h3>
    <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 15px; margin-top: 20px; text-align: center;">
        
        <div style="background: #222; padding: 15px; border-radius: 8px;">
            <i class="fas fa-hard-hat fa-2x" style="color: #e67e22; margin-bottom: 10px;"></i>
            <div style="font-size: 1.5rem; font-weight: bold;">{{ stats.jobs }}</div>
            <div style="font-size: 0.8rem; color: #888;">Total Jobs</div>
        </div>

        <div style="background: #222; padding: 15px; border-radius: 8px;">
            <i class="fas fa-file-invoice fa-2x" style="color: #9b59b6; margin-bottom: 10px;"></i>
            <div style="font-size: 1.5rem; font-weight: bold;">{{ stats.quotes }}</div>
            <div style="font-size: 0.8rem; color: #888;">Quotes</div>
        </div>

        <div style="background: #222; padding: 15px; border-radius: 8px;">
            <i class="fas fa-file-invoice-dollar fa-2x" style="color: #2ecc71; margin-bottom: 10px;"></i>
            <div style="font-size: 1.5rem; font-weight: bold;">{{ stats.invoices }}</div>
            <div style="font-size: 0.8rem; color: #888;">Invoices</div>
        </div>

        <div style="background: #222; padding: 15px; border-radius: 8px;">
            <i class="fas fa-truck fa-2x" style="color: #3498db; margin-bottom: 10px;"></i>
            <div style="font-size: 1.5rem; font-weight: bold;">{{ stats.vehicles }}</div>
            <div style="font-size: 0.8rem; color: #888;">Vehicles</div>
        </div>

        <div style="background: #222; padding: 15px; border-radius: 8px;">
            <i class="fas fa-exclamation-circle fa-2x" style="color: #e74c3c; margin-bottom: 10px;"></i>
            <div style="font-size: 1.5rem; font-weight: bold;">{{ stats.service_requests }}</div>
            <div style="font-size: 0.8rem; color: #888;">Requests</div>
        </div>

    </div>
</div>

<div class="admin-card" style="border: 1px solid #c0392b;">
    <h3 style="color: #c0392b;"><i class="fas fa-exclamation-triangle"></i> Administrative Actions</h3>
    <div style="margin-top: 15px; display: flex; gap: 10px;">
        <a href="/admin/suspend/{{ company.id }}" class="btn-main" style="background: #e67e22; border: none;">
            {{ 'Unsuspend' if company.status == 'Suspended' else 'Suspend Account' }}
        </a>
        <a href="/admin/delete-tenant/{{ company.id }}" class="btn-main" style="background: #c0392b; border: none;" onclick="return confirm('WARNING: This will delete ALL data for this company permanently. Continue?');">
            Delete Tenant
        </a>
    </div>
</div>

{% endblock %}
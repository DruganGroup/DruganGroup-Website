<!DOCTYPE html>
<html>
<head>
    <style>
        :root { --brand-color: {{ config.color or '#333' }}; }
        body { font-family: 'Helvetica', sans-serif; color: #333; margin: 0; padding: 40px; }
        
        /* Layout */
        .header { display: flex; justify-content: space-between; border-bottom: 3px solid var(--brand-color); padding-bottom: 20px; margin-bottom: 30px; }
        .logo { max-height: 70px; }
        
        /* Modern vs Classic Toggles */
        .theme-modern .inv-title { color: var(--brand-color); text-transform: uppercase; letter-spacing: 2px; }
        .theme-classic { text-align: center; }
        .theme-classic .header { flex-direction: column; border-bottom: 1px solid #ccc; }

        table { width: 100%; border-collapse: collapse; margin-top: 30px; }
        th { background: var(--brand-color); color: white; padding: 12px; text-align: left; }
        td { padding: 12px; border-bottom: 1px solid #eee; }
        .totals { margin-top: 30px; text-align: right; }
        .grand-total { font-size: 1.5rem; font-weight: bold; color: var(--brand-color); }
    </style>
</head>
<body class="theme-{{ settings.get('invoice_template', 'modern') }}">
    <div class="header">
        <div class="company-info">
            <img src="{{ config.logo }}" class="logo">
            <h2>{{ company.name }}</h2>
        </div>
        <div class="inv-details">
            <h1 class="inv-title">INVOICE</h1>
            <p><strong>Ref:</strong> {{ invoice.ref }}</p>
            <p><strong>Date:</strong> {{ invoice.date }}</p>
        </div>
    </div>

    <div class="client-box">
        <h4 style="margin-bottom:5px;">Bill To:</h4>
        <strong>{{ invoice.client_name }}</strong><br>
        {{ invoice.client_address | replace('\n', '<br>') | safe }}
    </div>

    <table>
        <thead>
            <tr>
                <th>Description</th>
                <th>Qty</th>
                <th>Unit Price</th>
                <th>Total</th>
            </tr>
        </thead>
        <tbody>
            {% for item in items %}
            <tr>
                <td>{{ item.desc }}</td>
                <td>{{ item.qty }}</td>
                <td>£{{ "%.2f"|format(item.price) }}</td>
                <td>£{{ "%.2f"|format(item.total) }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <div class="totals">
        <div class="grand-total">Total Due: £{{ "%.2f"|format(invoice.total) }}</div>
        <p style="margin-top:40px; font-size:0.8rem; color:#888;">
            {{ settings.get('invoice_footer', 'Thank you for your business!') }}
        </p>
    </div>
</body>
</html>